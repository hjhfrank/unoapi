CREATE TABLE P01 (
    GP_ID    VARCHAR(20),
    GP_NAME  VARCHAR(30),
    L1DISC   INT,
    L2DISC   INT,
    L3DISC   INT,
    SALE01   INT,
    SALE02   INT,
    YN01     VARCHAR(01),
PRIMARY KEY(GP_ID));

INSERT INTO P01 (GP_ID,GP_NAME,L1DISC,L2DISC,L3DISC,SALE01,SALE02,YN01) VALUES ('A','TEST1',900,1900,2900,100000,90000,'Y');
INSERT INTO P01 (GP_ID,GP_NAME,L1DISC,L2DISC,L3DISC,SALE01,SALE02,YN01) VALUES ('B','TEST2',900,1900,2900,100000,90000,'N');

CREATE TABLE P02 (
    TR_ID    VARCHAR(10),
    TR_NAME  VARCHAR(40),
PRIMARY KEY(TR_ID))  

INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('0001','王大明');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('0002','王一明');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('0003','王二明');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('0004','王三明');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('0005','趙三明');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('0006','趙大明');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('0007','趙一明');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('0008','趙二明');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN01','旅客01');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN02','旅客02');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN03','旅客03');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN04','旅客04');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN05','旅客05');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN06','旅客06');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN07','旅客07');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN08','旅客08');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN09','旅客09');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN10','旅客10');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN11','旅客11');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN12','旅客12');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN13','旅客13');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN14','旅客14');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN15','旅客15');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN16','旅客16');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN17','旅客17');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN18','旅客18');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN19','旅客19');
INSERT INTO P02 (TR_ID,TR_NAME) VALUES ('UN20','旅客20');

CREATE TABLE P03M (
    TRN_NO  VARCHAR(14),
    GP_ID   VARCHAR(20),
    GP_NAME VARCHAR(30),
    P_ID    VARCHAR(10),
    P_NAME  VARCHAR(30),
    VDATE1  VARCHAR(08),
    LDISC   INT Default 0,
    L1DISC  INT,
    L2DISC  INT,
    L3DISC  INT,
    YN01    VARCHAR(01),
	VSTEP   VARCHAR(02),
    --以下為EEP FLOW必開欄位
    UPDATE_USER        VARCHAR(20) NULL,
    UPDATE_DATE        VARCHAR(08) NULL,
    UPDATE_TIME        VARCHAR(06) NULL,
    SYSFLAG            CHAR(01)    NULL,
    LASTUPDATEDATETIME VARCHAR(14) NULL,
    BILLTYPE           VARCHAR(10) NULL,
    FLOWFLAG           CHAR(01)    NULL,
    FLOWIMPORTANT      CHAR(01)    NULL,
    FLOWURGENT         CHAR(01)    NULL,
    RECORD_OWNER       VARCHAR(20) NULL,
    RECORD_OWNER_R     VARCHAR(12) NULL,
PRIMARY KEY(TRN_NO));     

CREATE TABLE P03S (
    TRN_NO  VARCHAR(14),
    SEC     VARCHAR(03),  
    P_ID    VARCHAR(10),
    P_NAME  VARCHAR(30),
    SALE    INT,  
PRIMARY KEY(TRN_NO,SEC));         

CREATE TABLE AUTONUM (
	[NUMBERNAME] [varchar](20) NOT NULL,
	[CURRENTPREFIX] [varchar](20) NOT NULL,
	[DIGITSWIDTH] [int] NOT NULL,
	[CURRENTDIGITS] [int] NOT NULL,
	[VALUEINTERVAL] [int] NOT NULL,
	[MINVALUE] [int] NOT NULL,
	[MAXVALUE] [int] NOT NULL,
PRIMARY KEY(NUMBERNAME,CURRENTPREFIX))

CREATE TABLE P04M (    
    GP_ID   VARCHAR(20),
    GP_NAME VARCHAR(30),
    P_ID    VARCHAR(10),
    P_NAME  VARCHAR(30),
    VDATE1  VARCHAR(08),   
	VSTEP   VARCHAR(02),
    --以下為EEP FLOW必開欄位
    UPDATE_USER        VARCHAR(20) NULL,
    UPDATE_DATE        VARCHAR(08) NULL,
    UPDATE_TIME        VARCHAR(06) NULL,
    SYSFLAG            CHAR(01)    NULL,
    LASTUPDATEDATETIME VARCHAR(14) NULL,
    BILLTYPE           VARCHAR(10) NULL,
    FLOWFLAG           CHAR(01)    NULL,
    FLOWIMPORTANT      CHAR(01)    NULL,
    FLOWURGENT         CHAR(01)    NULL,
    RECORD_OWNER       VARCHAR(20) NULL,
    RECORD_OWNER_R     VARCHAR(12) NULL,
PRIMARY KEY(GP_ID));     

CREATE TABLE P04SD1 (    
    GP_ID   VARCHAR(20),
    SEC     VARCHAR(02),  
PRIMARY KEY(GP_ID,SEC));     

CREATE TABLE P04SD2 (    
    GP_ID   VARCHAR(20),
    SEC     VARCHAR(02),  
PRIMARY KEY(GP_ID,SEC));     

INSERT INTO P04M (GP_ID,GP_NAME) VALUES ('A','TEST1');
INSERT INTO P04M (GP_ID,GP_NAME) VALUES ('B','TEST2');

CREATE TABLE P05 (
    CP_ID    VARCHAR(10),
    CP_NAME  VARCHAR(40),
PRIMARY KEY(CP_ID));

INSERT INTO P05 (CP_ID,CP_NAME) VALUES ('C01','同業1');
INSERT INTO P05 (CP_ID,CP_NAME) VALUES ('C02','同業2');


PAZ14LA240925A


var                                                                                                                           
    s1:string;                                                                                                                
begin                                                                                                                         
   s1:=formatdatetime('yyyymmdd',now);                                                                                        
   Params.ParamByName('TRN_NO').AsString:=AutoNumber1.GetNewAutoNum('NUMBERNAME;CURRENTPREFIX',VarArrayof(['A',s1]));         
end;                                                                                                                          



select
  WF_TODOLIST.LISTID,
  WF_TODOLIST.FLOW_ID,
  WF_TODOLIST.S_STEP_ID,
  WF_TODOLIST.S_USER_ID,
  WF_TODOLIST.D_STEP_ID,
  WF_TODOLIST.SENDTO_KIND,
  WF_TODOLIST.SENDTO_ID,
  WF_TODOLIST.FLOWIMPORTANT,
  WF_TODOLIST.FLOWURGENT,
  WF_TODOLIST.STATUS,
  WF_TODOLIST.FORM_TABLE,
  WF_TODOLIST.FORM_KEYS,
  WF_TODOLIST.FORM_PRESENTATION,
  WF_TODOLIST.FORM_PRESENT_CT,
  WF_TODOLIST.REMARK,
  WF_TODOLIST.UPDATE_USER,
  WF_TODOLIST.UPDATE_DATE,
  WF_TODOLIST.UPDATE_TIME,
  WF_TODOLIST.SYSFLAG,
  WF_TODOLIST.LASTUPDATEDATETIME,
  SSTEP.STEP_DESC,
  DSTEP.STEP_DESC,
  DSTEP.EXP_TIME,
  DSTEP.TIME_UNIT,
  WF_FLOWS.FLOW_DESC
from WF_TODOLIST
left join WF_FLOWS ON WF_FLOWS.FLOW_ID = WF_TODOLIST.FLOW_ID
left join WF_FLOWSTEPS SSTEP ON SSTEP.FLOW_ID = WF_TODOLIST.FLOW_ID AND
                                SSTEP.STEP_ID = WF_TODOLIST.S_STEP_ID
left join WF_FLOWSTEPS DSTEP ON DSTEP.FLOW_ID = WF_TODOLIST.FLOW_ID AND
                                DSTEP.STEP_ID = WF_TODOLIST.D_STEP_ID
where LISTID = '0925160833wZWBBkitiO'


TRUNCATE TABLE AUTONUM;
truncate table WF_TODOHIS;
truncate table WF_TODOLIST;
TRUNCATE TABLE P03M;
TRUNCATE TABLE P03S;
 

 CREATE VIEW PANAME 
 As
   SELECT TR_ID P_ID,TR_NAME P_NAME FROM P02
   UNION
   SELECT CP_ID P_ID,CP_NAME P_NAME FROM P05


CREATE TABLE CITEMA (
    SEC         VARCHAR(02),
    ITEMNAME    VARCHAR(60),
    PRICE       INT,
    PFUNC       VARCHAR(40),
PRIMARY KEY(SEC));


CREATE TABLE CITEMB (
    SUPP_ID     VARCHAR(10),
    ITEMNAME    VARCHAR(60), 
PRIMARY KEY(SUPP_ID));

CREATE TABLE CITEMBM (
    TRN_NO     VARCHAR(10),
    ITEMNAME   VARCHAR(20), 
PRIMARY KEY(TRN_NO));

CREATE TABLE CITEMBS (
    TRN_NO     VARCHAR(10),     
    SEC        VARCHAR(04),
    SUPP_ID    VARCHAR(10),
    SUPP_NAME  VARCHAR(60),
    PRICE1     DECIMAL(8,2), 
    PRICE2     DECIMAL(8,2), 
    TAX        DECIMAL(8,2), 
    PTR        decimal(8,2),
PRIMARY KEY(TRN_NO,SEC));

CREATE TABLE CITEMBS1 (
    TRN_NO     VARCHAR(10),     
    SEC        VARCHAR(01),   
PRIMARY KEY(TRN_NO,SEC));


CREATE TABLE CITEMGM (
    TRN_NO     VARCHAR(10),
    ITEMNAME   VARCHAR(20), 
PRIMARY KEY(TRN_NO));

CREATE TABLE CITEMGS1 (
    TRN_NO     VARCHAR(10),
    SEC        VARCHAR(04),
    ITEMNAME   VARCHAR(60),
    PRICE      DECIMAL(8,2), 
PRIMARY KEY(TRN_NO,SEC));

CREATE TABLE CITEMGS2 (
    TRN_NO     VARCHAR(10),
    SEC        VARCHAR(04),
    SEC1       VARCHAR(04),
    CLNAME     VARCHAR(20),  
    QTY        INT,
    PRICE      DECIMAL(8,2),     
    PFUNC      VARCHAR(20),
PRIMARY KEY(TRN_NO,SEC,SEC1));
